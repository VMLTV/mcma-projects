subprojects {
    task copyPackageJson(type: Copy) {
        from "package.json"
        into "build/staging"
    }

    task npmPack(type: Exec) {
        dependsOn ":verifyNodeJS"
        dependsOn copyPackageJson
        dependsOn tsc
        enabled file("package.json").exists()
        inputs.file "package.json"
        inputs.files fileTree(dir: ".", includes: [ "**/*.ts", "**/*.js"]).getFiles()
        outputs.dir "build/dist"
        commandLine npmExecutable
        args "pack", "..\\staging"
        workingDir "build/dist"

        doFirst {
            mkdir "build/dist"
        }
    }
}
